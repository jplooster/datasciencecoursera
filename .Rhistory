15/exp(minus_d2*0.3-0.03)
15/exp(minus_d2*0.3+0.015)
d2 <- -minus_d2
d1 <- d2 + 0.3
15*exp(0.3*d1-0.105)
cor_ret <- function(pd) {
0.03 + 0.13*exp(-35 * pd)
}
cor_ret(0.01)
cor_sov(0.01)
cor_sov <- function(pd){
0.12*(1 + exp(-50 * pd))
}
cor_sov(0.01)
cor <- cor_ret(0.01)
0.06 + 0.3^2/2
0.06 + 0.5 * 0.3^2
B <- 15
sigmaV <- 0.3
T <- 1
pd <- 0.02
r <- 0.06
V0 <- function(B, sigmaV, pd, T, r,) {
B/exp(qnorm(pd)*sigmaV*sqrt(T) + T * (r - 0.5 * sigmaV^2))
}
V0 <- function(B, sigmaV, pd, T, r) {
B/exp(qnorm(pd)*sigmaV*sqrt(T) + T * (r - 0.5 * sigmaV^2))
}
V0
V0()
V0(B, sigmaV, pd, T, r)
?optim
cor_sov <- function(pd){
0.12*(1 + exp(-50 * pd))
}
cor_sov(0.003)
pd <- 0.003
cor <- cor_sov(pd)
wcdr <- wcdr(pd, cor)
wcdr <- function(pd, cor) {
pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
}
wcdr1 <- wcdr(pd, cor)
assets <- 500
lgd <- 0.6
capreq(assets, lgd, wcdr1, pd)
capreq <- function(assets, lgd, wcdr, pd) {
assets * lgd * (wcdr - pd)
}
capreq1 <- capreq(assets, lgd, wcdr1, pd)
rwa <- function(capreq) {
12.5 * capreq
}
rwa(capreq1)
capreq1
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 x log(pd))^2
ma <- (1 + (m - 2.5) * b) / ((1 - 1.5) * b)
CapReq <- assets * lgd * (wcdr - pd) * ma
RWA <- 12.5 * CapReq
Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
Result
}
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 x log(pd))^2)
ma <- (1 + (m - 2.5) * b) / ((1 - 1.5) * b)
CapReq <- assets * lgd * (wcdr - pd) * ma
RWA <- 12.5 * CapReq
Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
Result
}
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
#        b <- (0.11852 - 0.05478 x log(pd))^2)
#        ma <- (1 + (m - 2.5) * b) / ((1 - 1.5) * b)
#        CapReq <- assets * lgd * (wcdr - pd) * ma
#        RWA <- 12.5 * CapReq
#        Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
#        Result
}
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 x log(pd))^2)
#        ma <- (1 + (m - 2.5) * b) / ((1 - 1.5) * b)
#        CapReq <- assets * lgd * (wcdr - pd) * ma
#        RWA <- 12.5 * CapReq
#        Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
#        Result
}
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 x log(pd))^2
#        ma <- (1 + (m - 2.5) * b) / ((1 - 1.5) * b)
#        CapReq <- assets * lgd * (wcdr - pd) * ma
#        RWA <- 12.5 * CapReq
#        Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
#        Result
}
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
#        ma <- (1 + (m - 2.5) * b) / ((1 - 1.5) * b)
#        CapReq <- assets * lgd * (wcdr - pd) * ma
#        RWA <- 12.5 * CapReq
#        Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
#        Result
}
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
ma <- (1 + (m - 2.5) * b) / ((1 - 1.5) * b)
CapReq <- assets * lgd * (wcdr - pd) * ma
RWA <- 12.5 * CapReq
Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
Result
}
cor_sov <- function(pd){
0.12*(1 + exp(-50 * pd))
}
cor(0.003)
cor <- cor_sov(0.003)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
ma <- (1 + (m - 2.5) * b) / ((1 - 1.5) * b)
CapReq <- assets * lgd * (wcdr - pd) * ma
RWA <- 12.5 * CapReq
Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
Result
}
capreq(0.003, cor, 500, 0.6, 3)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
ma <- (1 + (m - 2.5) * b) / ((1 - 1.5) * b)
CapReq <- assets * lgd * (wcdr - pd) * ma
RWA <- 12.5 * CapReq
Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
as.integer(Result)
}
capreq(0.003, cor, 500, 0.6, 3)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
ma <- (1 + (m - 2.5) * b) / ((1 - 1.5) * b)
CapReq <- assets * lgd * (wcdr - pd) * ma
RWA <- 12.5 * CapReq
Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
as.numeric(Result)
}
capreq(0.003, cor, 500, 0.6, 3)
(0.11852 - 0.05478 * log(0.003))^2
(1 + (m - 2.5) * 0.1907) / ((1 - 1.5) * 0.1907)
(1 + (3 - 2.5) * 0.1907) / ((1 - 1.5) * 0.1907)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
ma <- (1 + (m - 2.5) * b) / (1 - 1.5 * b)
CapReq <- assets * lgd * (wcdr - pd) * ma
RWA <- 12.5 * CapReq
Result <- c("WCDR" = wcdr, "Capital Requirements" = CapReq, "RWA" = RWA)
as.numeric(Result)
}
capreq(0.003, cor, 500, 0.6, 3)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
ma <- (1 + (m - 2.5) * b) / (1 - 1.5 * b)
CapReq <- assets * lgd * (wcdr - pd) * ma
RWA <- 12.5 * CapReq
Result <- c("CapReq" = CapReq, "RWA" = RWA, "WCDR" = wcdr, "MA" = ma)
Result
}
capreq(0.003, cor, 500, 0.6, 3)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
ma <- (1 + (m - 2.5) * b) / (1 - 1.5 * b)
RWA <- 12.5 * assets * lgd * (wcdr - pd) * ma
CapReq <- 0.08 * RWA
Result <- c("CapReq" = CapReq, "RWA" = RWA, "WCDR" = wcdr, "MA" = ma)
Result
}
capreq(0.003, cor, 500, 0.6, 3)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
ma <- round((1 + (m - 2.5) * b) / (1 - 1.5 * b), digits = 2)
RWA <- 12.5 * assets * lgd * (wcdr - pd) * ma
CapReq <- 0.08 * RWA
Result <- c("CapReq" = CapReq, "RWA" = RWA, "WCDR" = wcdr, "MA" = ma)
Result
}
capreq(0.003, cor, 500, 0.6, 3)
cor_sov <- function(pd){
round(0.12*(1 + exp(-50 * pd)), digits = 4)
}
cor <- cor_sov(0.003)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
ma <- round((1 + (m - 2.5) * b) / (1 - 1.5 * b), digits = 2)
RWA <- 12.5 * assets * lgd * (wcdr - pd) * ma
CapReq <- 0.08 * RWA
Result <- round(c("CapReq" = CapReq, "RWA" = RWA, "WCDR" = wcdr, "MA" = ma), digits = 2)
Result
}
capreq(0.003, cor, 500, 0.6, 3)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor))
b <- (0.11852 - 0.05478 * log(pd))^2
ma <- round((1 + (m - 2.5) * b) / (1 - 1.5 * b), digits = 2)
RWA <- 12.5 * assets * lgd * (wcdr - pd) * ma
CapReq <- 0.08 * RWA
Result <- round(c("CapReq" = CapReq, "RWA" = RWA, "WCDR" = wcdr, "MA" = ma), digits = 4)
Result
}
capreq(0.003, cor, 500, 0.6, 3)
12.5*500*0.6*(0.0720-0.003)*1.53
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- round(pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor)), digits = 3)
b <- round((0.11852 - 0.05478 * log(pd))^2, digits = 4)
ma <- round((1 + (m - 2.5) * b) / (1 - 1.5 * b), digits = 2)
RWA <- 12.5 * assets * lgd * (wcdr - pd) * ma
CapReq <- 0.08 * RWA
Result <- round(c("CapReq" = CapReq, "RWA" = RWA, "WCDR" = wcdr, "MA" = ma), digits = 4)
Result
}
capreq(0.003, cor, 500, 0.6, 3)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- round(pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor)), digits = 4)
b <- round((0.11852 - 0.05478 * log(pd))^2, digits = 4)
ma <- round((1 + (m - 2.5) * b) / (1 - 1.5 * b), digits = 4)
RWA <- 12.5 * assets * lgd * (wcdr - pd) * ma
CapReq <- 0.08 * RWA
Result <- round(c("CapReq" = CapReq, "RWA" = RWA, "WCDR" = wcdr, "MA" = ma), digits = 4)
Result
}
capreq(0.003, cor, 500, 0.6, 3)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- round(pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor)), digits = 4)
b <- round((0.11852 - 0.05478 * log(pd))^2, digits = 4)
ma <- round((1 + (m - 2.5) * b) / (1 - 1.5 * b), digits = 2)
RWA <- 12.5 * assets * lgd * (wcdr - pd) * ma
CapReq <- 0.08 * RWA
Result <- round(c("CapReq" = CapReq, "RWA" = RWA, "WCDR" = wcdr, "MA" = ma), digits = 4)
Result
}
capreq(0.003, cor, 500, 0.6, 3)
capreq <- function(pd, cor, assets, lgd, m) {
wcdr <- round(pnorm((qnorm(pd) + sqrt(cor) * qnorm(0.999))/sqrt(1 - cor)), digits = 4)
b <- round((0.11852 - 0.05478 * log(pd))^2, digits = 4)
ma <- round((1 + (m - 2.5) * b) / (1 - 1.5 * b), digits = 4)
RWA <- 12.5 * assets * lgd * (wcdr - pd) * ma
CapReq <- 0.08 * RWA
Result <- round(c("CapReq" = CapReq, "RWA" = RWA, "WCDR" = wcdr, "MA" = ma), digits = 4)
Result
}
capreq(0.003, cor, 500, 0.6, 3)
cor <- cor_sov(0.02)
cor
capreq(0.02, cor, 200, 0.70, 1)
pd <- function(cds, recrate) {
result <- (cds/100)/(1 - recrate)
result
}
avg_pd <- function(pd1, pd2, t1, t2) {
result <- (t2 * pd2 - t1 * pd1)/ (t2 - t1)
result
}
pd1 <- pd(60, 0.60)
pd1
pd <- function(cds, recrate) {
result <- (cds/10000)/(1 - recrate)
result
}
avg_pd <- function(pd1, pd2, t1, t2) {
result <- (t2 * pd2 - t1 * pd1)/ (t2 - t1)
result
}
pd1 <- pd(60, 0.60)
pd1
pd2 <- pd(100, 0.60)
pd2
avg_pd(pd1, pd2, 5, 10)
pd1 <- pd(120, 0.4)
pd1
pd2 <- pd(160, 0.4)
pd2
avg_pd(pd1, pd2, 2, 5)
qnorm(0.0122)
qnorm(0.0122+0.09)
qnorm(0.0122+0.0009)
qnorm(0.0131)
x <- 1:4
p <- x/sum(x)
temp <- rbind(x, p)
rownames(temp) <- c("X", "Prob")
temp
mean(x)
?xyplot
??xyplot
xyplot(x, p)
lattice
library(lattice)
xyplot(x, p)
?xyplot
x
library(UsingR); data(galton)
library(package)
install.packages("UsingR")
library(UsingR); data(galton)
data(galton)
par(mfrow=c(1,2))
hist(galton$child, col = "blue", breaks = 100)
hist(galton$parent, col = "blue", breaks = 100)
library(manipulate)
x <- c(0.18, -1.54, 0.42, 0.95)
w <- c(2, 1, 3, 1)
data(mtcars)
?lm
lm(mtcars$weight ~ mtcars$mpg)
head(mtcars)
summary(mtcars)
lm(mtcars$wt ~ mtcars$mpg)
1/0.1409
x <- c(0.8, 0.47, 0.51, 0.73, 0.36, 0.58, 0.57, 0.85, 0.44, 0.42)
y <- c(1.39, 0.72, 1.55, 0.48, 1.19, -1.59, 1.23, -0.65, 1.49, 0.05)
lm(x ~ y)
lm(y ~ x)
lm(mtcars$mpg ~ mtcars$wt)
lm(y ~ x -1)
x <- c(0.18, -1.54, 0.42, 0.95)
lm(x, weights = w)
y <- x * w
y
mean(y)
z <- y^2
z
mean(z)
library(manipulate)
myHist <- function(mu){
hist(y,col="blue",breaks=100)
lines(c(mu, mu), c(0, 150),col="red",lwd=5)
mse <- mean((x2 - mu)^2)
text(-1, 2, paste("MSE = ", round(mse, 5)))
}
manipulate(myHist(mu), mu = slider(-1.6,0.95, step = 0.001))
library(manipulate)
myHist <- function(mu){
hist(y,col="blue",breaks=100)
lines(c(mu, mu), c(0, 150),col="red",lwd=5)
mse <- mean((y - mu)^2)
text(-1, 2, paste("MSE = ", round(mse, 5)))
}
manipulate(myHist(mu), mu = slider(-1.6,0.95, step = 0.001))
library(manipulate)
myHist <- function(mu){
hist(y,col="blue",breaks=100)
lines(c(mu, mu), c(0, 150),col="red",lwd=5)
mse <- mean((y - mu)^2)
text(-1, 2, paste("MSE = ", round(mse, 5)))
}
manipulate(myHist(mu), mu = slider(-1.6,0.95, step = 0.001))
library(manipulate)
myHist <- function(mu){
hist(galton$child,col="blue",breaks=100)
lines(c(mu, mu), c(0, 150),col="red",lwd=5)
mse <- mean((galton$child - mu)^2)
text(63, 150, paste("mu = ", mu))
text(63, 140, paste("MSE = ", round(mse, 2)))
}
manipulate(myHist(mu), mu = slider(62, 74, step = 0.5))
par(mfrow=c(1,1))
library(manipulate)
myHist <- function(mu){
hist(galton$child,col="blue",breaks=100)
lines(c(mu, mu), c(0, 150),col="red",lwd=5)
mse <- mean((galton$child - mu)^2)
text(63, 150, paste("mu = ", mu))
text(63, 140, paste("MSE = ", round(mse, 2)))
}
manipulate(myHist(mu), mu = slider(62, 74, step = 0.5))
library(manipulate)
myHist <- function(mu){
hist(y,col="blue",breaks=100)
lines(c(mu, mu), c(0, 150),col="red",lwd=5)
mse <- mean((y - mu)^2)
text(63, 150, paste("mu = ", mu))
text(63, 140, paste("MSE = ", round(mse, 2)))
}
manipulate(myHist(mu), mu = slider(-2, 2, step = 0.01))
library(manipulate)
myHist <- function(mu){
hist(y,col="blue",breaks=100)
lines(c(mu, mu), c(0, 150),col="red",lwd=5)
mse <- mean((y - mu)^2)
text(-1.5, 1.0, paste("mu = ", mu))
text(-1.5, 0.8, paste("MSE = ", round(mse, 2)))
}
manipulate(myHist(mu), mu = slider(-2, 2, step = 0.01))
library(manipulate)
myHist <- function(mu){
hist(y,col="blue",breaks=100)
lines(c(mu, mu), c(0, 150),col="red",lwd=5)
mse <- mean((y - mu)^2)
text(-1, 1.0, paste("mu = ", mu))
text(-1, 0.9, paste("MSE = ", round(mse, 2)))
}
manipulate(myHist(mu), mu = slider(-2, 2, step = 0.01))
?download.file
file <- download.file(https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv, method = "curl")
file <- download.file("https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv", method = "curl")
setwd("~/Desktop/Code/R/datasciencecoursera")
file <- download.file("https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Fss06hid.csv", destfile = "microdata.csv",method = "curl")
file
file <- read.csv("microdata.csv")
file
head(file)
filesubset <- file[file$val > 23, ]
filesubset
file$val
filesubset <- file[file$VAL > 23, ]
filsubset
filesubset
length(file$VAL > 23)
length(file$VAL > 24)
length(file$VAL)
file$VAL
file$VAL == 24
filesubset <- file[file$VAL == 24, ]
filesubset
?read.csv
file <- read.table("microdata.csv", sep = "," na.strings = "NA")
file <- read.table("microdata.csv", sep = ",", na.strings = "NA")
filesubset <- file[file$VAL == 24, ]
filesubset
file$VAL == 24
file$VAL
head(file)
file$VAL
class(file$VAL)
as.numeric(file$VAL)
?na
??NA
file <- read.csv("microdata.csv", )
filesubset <- file(file$VAL == 24, )
filesubset <- file[file$VAL == 24, ]
filesubset
filesubset <- file[!is.na ]
?is.NA
??is.NA
filesubset <- !is.na(file)
filesubset
filesubset <- file[!is.na(file)]
filesubset
filesubset <- file[!is.na(file$VAL)]
filesubset <- file[!is.na(file$VAL), ]
filesubset
filesubset2 <- filesubset[filesubset$VAL == 24, ]
filesubset2
library(xlsx)
install.packages(xlsx)
install.packages(xlsxjars)
install.packages(rJava)
install.packages
install.packages()
?install.packages
install.packages("xlsx")
download.file("https://d396qusza40orc.cloudfront.net/getdata%2Fdata%2FDATA.gov_NGAP.xlsx
", method = 'curl', mode = 'wb', destfile = 'NatGas')
rawdat <- read.xlsx('NatGas', sheetIndex = 1, header = TRUE)
library(xlsx)
rawdat <- read.xlsx('NatGas', sheetIndex = 1, header = TRUE)
head(rawdat)
names(rawdat)
rawdat <- read.xlsx('NatGas', sheetIndex = 1)
names(rawdat)
rawdat[18,23]
rawdat[18,]
rawdat[17,]
dat <- rawdat[17:23,7:15]
dat
sum(dat$Zip*dat$Ext,na.rm=T)
?read.xlsx
dat <- read.xlsx('NatGas', sheetIndex = 1, header = TRUE, startRow = 18, endRow = 23, colIndex = c(7:15))
dat
sum(dat$Zip*dat$Ext,na.rm=T)
install.packages('XML')
download.file('http://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Frestaurants.xml', method = 'curl', destfile = 'Restuarants.xml')
doc <- xmlTreeParse(http://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Frestaurants.xml, useInternal = True)
doc <- xmlTreeParse('http://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Frestaurants.xml', useInternal = True)
library(XMP)
library(XML)
doc <- xmlTreeParse('http://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Frestaurants.xml', useInternal = True)
doc <- xmlTreeParse('http://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Frestaurants.xml')
zips <- xpathSApply(doc,"//zipcode",xmlValue)
doc <- xmlTreeParse('http://d396qusza40orc.cloudfront.net/getdata%2Fdata%2Frestaurants.xml', useInternal=TRUE)
zips <- xpathSApply(doc,"//zipcode",xmlValue)
zips
rootNode <- xmlRoot(doc)
xmlName(rootNode)
names(rootNode)
rootNode[[1]]
rootNode[[1]][[1]]
zips <- xpathSApply(doc,"//zipcode",xmlValue)
head(zips)
zips_21231 <- zips[zips == 21231]
zips_21231
length(zips_21231)
